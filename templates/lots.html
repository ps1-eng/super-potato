{% extends 'base.html' %}

{% block content %}
<section class="card">
  <div class="item-header">
    <h2>Boxes / Lots</h2>
    <a class="button" href="{{ url_for('split_box_wizard') }}">Create box</a>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Reference</th>
          <th>Purchased</th>
          <th>Total cost</th>
          <th>Allocated</th>
          <th>Remaining</th>
          <th>Items</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for lot in lots %}
          <tr>
            <td><a href="{{ url_for('lot_detail', lot_id=lot.id) }}">{{ lot.reference }}</a></td>
            <td>{{ lot.purchase_date }} Â· {{ lot.purchase_source }}</td>
            <td>{{ lot.total_cost | currency }}</td>
            <td>{{ lot.allocated_cost | currency }}</td>
            <td>{{ (lot.total_cost - lot.allocated_cost) | currency }}</td>
            <td>{{ lot.item_count }}</td>
            <td>{% if lot.is_finalized %}Finalised{% else %}Open{% endif %}</td>
          </tr>
        {% else %}
          <tr>
            <td colspan="7" class="empty">No boxes yet.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
